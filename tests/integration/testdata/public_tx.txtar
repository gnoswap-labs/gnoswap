loadpkg gno.land/p/demo/avl
loadpkg gno.land/p/demo/ufmt
loadpkg gno.land/p/demo/json
loadpkg gno.land/p/demo/ownable
loadpkg gno.land/p/demo/grc/grc20
loadpkg gno.land/p/demo/grc/grc721

loadpkg gno.land/r/demo/users
loadpkg gno.land/r/gnoland/wugnot
loadpkg gno.land/r/demo/grc20reg

adduser user2
adduser user3


## start a new node
gnoland start


## deploy test-tokens

### deploy usdc
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/test_token/usdc -pkgpath gno.land/r/gnoswap/v1/test_token/usdc -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy foo
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/test_token/foo -pkgpath gno.land/r/gnoswap/v1/test_token/foo -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy bar
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/test_token/bar -pkgpath gno.land/r/gnoswap/v1/test_token/bar -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy baz
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/test_token/baz -pkgpath gno.land/r/gnoswap/v1/test_token/baz -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy qux
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/test_token/qux -pkgpath gno.land/r/gnoswap/v1/test_token/qux -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy obl
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/test_token/obl -pkgpath gno.land/r/gnoswap/v1/test_token/obl -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1



## deploy packages

### deploy uint256
gnokey maketx addpkg -pkgdir ../../contract/p/gnoswap/uint256 -pkgpath gno.land/p/gnoswap/uint256 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

## deploy int256
gnokey maketx addpkg -pkgdir ../../contract/p/gnoswap/int256 -pkgpath gno.land/p/gnoswap/int256 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

## deploy gnsmath
gnokey maketx addpkg -pkgdir ../../contract/p/gnoswap/gnsmath -pkgpath gno.land/p/gnoswap/gnsmath -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1



## deploy realm

### deploy common
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/common -pkgpath gno.land/r/gnoswap/v1/common -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy gns
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/gns -pkgpath gno.land/r/gnoswap/gns -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy gnft
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/gnft -pkgpath gno.land/r/gnoswap/v1/gnft -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy gov/xgns
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/gov/xgns -pkgpath gno.land/r/gnoswap/v1/gov/xgns -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy emission
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/emission -pkgpath gno.land/r/gnoswap/emission -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy protocol_fee
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/protocol_fee -pkgpath gno.land/r/gnoswap/v1/protocol_fee -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy referral
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/referral -pkgpath gno.land/r/gnoswap/referral -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy pool
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/pool -pkgpath gno.land/r/gnoswap/v1/pool -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy position
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/position -pkgpath gno.land/r/gnoswap/v1/position -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy router
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/router -pkgpath gno.land/r/gnoswap/v1/router -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy staker
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/staker -pkgpath gno.land/r/gnoswap/v1/staker -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy community_pool
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/community_pool -pkgpath gno.land/r/gnoswap/v1/community_pool -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy gov/staker
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/gov/staker -pkgpath gno.land/r/gnoswap/v1/gov/staker -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy gov/governance
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/gov/governance -pkgpath gno.land/r/gnoswap/v1/gov/governance -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

### deploy launchpad
gnokey maketx addpkg -pkgdir ../../contract/r/gnoswap/launchpad -pkgpath gno.land/r/gnoswap/v1/launchpad -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1



# create pool
gnokey maketx call -pkgpath gno.land/r/gnoswap/gns -func Approve -args g148tjamj80yyrm309z7rk690an22thd2l3z8ank -args 18446744073709551615 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func CreatePool -args "gno.land/r/gnoland/wugnot" -args "gno.land/r/gnoswap/gns" -args 3000 -args 79228162514264337593543950337 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '{"key":"poolPath","value":"gno.land/r/gnoland/wugnot:gno.land/r/gnoswap/gns:3000"}'

# check created pool 
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func DoesPoolPathExist -args "gno.land/r/gnoland/wugnot:gno.land/r/gnoswap/gns:3000" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout true

# create another pool
gnokey maketx call -pkgpath gno.land/r/gnoswap/gns -func Approve -args g148tjamj80yyrm309z7rk690an22thd2l3z8ank -args 18446744073709551615 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func CreatePool -args "gno.land/r/gnoswap/v1/test_token/bar" -args "gno.land/r/gnoswap/v1/test_token/baz" -args 3000 -args 79228162514264337593543950337 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '{"key":"poolPath","value":"gno.land/r/gnoswap/v1/test_token/bar:gno.land/r/gnoswap/v1/test_token/baz:3000"}'

# create pool with wrong parameters should panic
## already existing pool
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func CreatePool -args "gno.land/r/gnoswap/v1/test_token/bar" -args "gno.land/r/gnoswap/v1/test_token/baz" -args 3000 -args 79228162514264337593543950337 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'pool already created'
## same token
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func CreatePool -args "gno.land/r/gnoswap/v1/test_token/bar" -args "gno.land/r/gnoswap/v1/test_token/bar" -args 3000 -args 79228162514264337593543950337 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'same token used in single pool'
## invalid fee
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func CreatePool -args "gno.land/r/gnoswap/v1/test_token/bar" -args "gno.land/r/gnoswap/v1/test_token/baz" -args 123 -args 79228162514264337593543950337 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'requested data not found'
## too low sqrt ratio
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func CreatePool -args "gno.land/r/gnoswap/v1/test_token/bar" -args "gno.land/r/gnoswap/v1/test_token/baz" -args 500 -args 4295128738 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'value out of range'
## too high sqrt ratio
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func CreatePool -args "gno.land/r/gnoswap/v1/test_token/bar" -args "gno.land/r/gnoswap/v1/test_token/baz" -args 500 -args 1461446703485210103287273052203988822378723970343 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'value out of range'


# pool creation fee getter & setter
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func GetPoolCreationFee -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 100000000

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func SetPoolCreationFeeByAdmin -args 0 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout OK

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func GetPoolCreationFee -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 0



# withdrawal fee getter & setter
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func GetWithdrawalFee -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 100

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func SetWithdrawalFeeByAdmin -args 0 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout OK

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/pool -func GetWithdrawalFee -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 0



# mint new position
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func ApiGetPositions -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/gns -func Approve -args g148tjamj80yyrm309z7rk690an22thd2l3z8ank -args 18446744073709551615 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoland/wugnot -func Approve -args g148tjamj80yyrm309z7rk690an22thd2l3z8ank -args 18446744073709551615 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoland/wugnot -func Approve -args g1q646ctzhvn60v492x8ucvyqnrj2w30cwh6efk5 -args 18446744073709551615 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func Mint -send "20000000ugnot" -args "gno.land/r/gnoswap/gns" -args "gnot" -args 3000 -args "-49980" -args "49980" -args 20000000 -args 20000000 -args 1 -args 1 -args 9999999999 -args g1jg8mtutu9khhfwc4nxmuhcpftf0pajdhfvsqf5 -args g1jg8mtutu9khhfwc4nxmuhcpftf0pajdhfvsqf5 -args "" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '(1 uint64)'

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func PositionGetPositionLiquidityStr -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '("21790703" string)'


# position mint with wrong parameters should panic
## invalid mintTo
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func Mint -send "20000000ugnot" -args "gno.land/r/gnoswap/gns" -args "gnot" -args 3000 -args "-49980" -args "49980" -args 20000000 -args 20000000 -args 1 -args 1 -args 9999999999 -args g1 -args g1jg8mtutu9khhfwc4nxmuhcpftf0pajdhfvsqf5 -args "" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'invalid address'
## invalid caller
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func Mint -send "20000000ugnot" -args "gno.land/r/gnoswap/gns" -args "gnot" -args 3000 -args "-49980" -args "49980" -args 20000000 -args 20000000 -args 1 -args 1 -args 9999999999 -args g1jg8mtutu9khhfwc4nxmuhcpftf0pajdhfvsqf5 -args g1 -args "" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'invalid address'
## invalid deadline
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func Mint -send "20000000ugnot" -args "gno.land/r/gnoswap/gns" -args "gnot" -args 3000 -args "-49980" -args "49980" -args 20000000 -args 20000000 -args 1 -args 1 -args 1234 -args g1jg8mtutu9khhfwc4nxmuhcpftf0pajdhfvsqf5 -args g1jg8mtutu9khhfwc4nxmuhcpftf0pajdhfvsqf5 -args "" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'transaction expired'



# increase liquditiy
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func IncreaseLiquidity -send "20000000ugnot" -args 1 -args 20000000 -args 20000000 -args 1 -args 1 -args 9999999999 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout OK

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func PositionGetPositionLiquidityStr -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '("43581406" string')


# increase liquditiy with wrong parameters should panic
## non exists position
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func IncreaseLiquidity -send "20000000ugnot" -args 2 -args 20000000 -args 20000000 -args 1 -args 1 -args 9999999999 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'position does not exist'
## invalid number string 
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func IncreaseLiquidity -send "20000000ugnot" -args 1 -args abc -args 20000000 -args 1 -args 1 -args 9999999999 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'invalid input data'
## sent coint amount does not match
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func IncreaseLiquidity -send "1ugnot" -args 1 -args 20000000 -args 20000000 -args 1 -args 1 -args 9999999999 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'Insufficient UGNOT provided'



# decrease liquditiy
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func DecreaseLiquidity -args 1 -args 81406 -args 0 -args 0 -args 9999999999 -args "false" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout OK

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func PositionGetPositionLiquidityStr -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '("43500000" string')


# decrease liquditiy with wrong parameters should panic
## too much liquiditiy
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func DecreaseLiquidity -args 1 -args 43500001 -args 0 -args 0 -args 9999999999 -args "false" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'invalid liquidity'



# swap exact in 
gnokey maketx call -pkgpath gno.land/r/gnoswap/gns -func Approve -args g148tjamj80yyrm309z7rk690an22thd2l3z8ank -args 18446744073709551615 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoland/wugnot -func Approve -args g1lm2l7tf49h3mykesct7rhfml30yx8dw5xrval7 -args 18446744073709551615 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/router -func ExactInSwapRoute -args "gno.land/r/gnoswap/gns" -args "gno.land/r/gnoland/wugnot" -args 50000 -args "gno.land/r/gnoswap/gns:gno.land/r/gnoland/wugnot:3000" -args "100" -args "0" -args 9999999999 -args "" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

# swap exact out
gnokey maketx call -pkgpath gno.land/r/gnoswap/gns -func Approve -args g148tjamj80yyrm309z7rk690an22thd2l3z8ank -args 18446744073709551615 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoland/wugnot -func Approve -args g1lm2l7tf49h3mykesct7rhfml30yx8dw5xrval7 -args 18446744073709551615 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/router -func ExactOutSwapRoute -args "gno.land/r/gnoswap/gns" -args "gno.land/r/gnoland/wugnot" -args 50000 -args "gno.land/r/gnoswap/gns:gno.land/r/gnoland/wugnot:3000" -args "100" -args "60000" -args 9999999999 -args "" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1


# swap with wrong parameters should panic
## not registered token
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/router -func ExactInSwapRoute -args "gno.land/r/gnoswap/v1/nope" -args "gno.land/r/gnoland/wugnot" -args 50000 -args "gno.land/r/gnoswap/v1/nope:gno.land/r/gnoland/wugnot:3000" -args "100" -args "0" -args 9999999999 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'token is not registered'
## route not found
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/router -func ExactOutSwapRoute -args "gno.land/r/gnoswap/gns" -args "gno.land/r/gnoland/wugnot" -args 50000 -args "" -args "100" -args "60000" -args 9999999999 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'invalid pool path'
## quote sum not 100
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/router -func ExactOutSwapRoute -args "gno.land/r/gnoswap/gns" -args "gno.land/r/gnoland/wugnot" -args 50000 -args "gno.land/r/gnoswap/gns:gno.land/r/gnoland/wugnot:3000" -args "95" -args "60000" -args 9999999999 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'quote sum'


# collect swap fee
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/position -func CollectFee -args 1 -args false -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '("300" string)'


# swap fee getter & setter
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/router -func GetSwapFee -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 15

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/router -func SetSwapFeeByAdmin -args 0 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout OK

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/router -func GetSwapFee -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 0

# stake position
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func IsStaked -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout false

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/gnft -func Approve -args g1cceshmzzlmrh7rr3z30j2t5mrvsq9yccysw9nu -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func StakeToken -args 1 -args "" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func IsStaked -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout true


# stake position with wrong parameter should panic
## non exist position
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func StakeToken -args 2 -args "" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'invalid token id'
## already staked position
! gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func StakeToken -args 1 -args "" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stderr 'already staked'


# collect staking reward
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func CollectReward -args 1 -args false -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1


# unstake token
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func UnStakeToken -args 1 -args true -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func IsStaked -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout false


# deposit gns amount getter & setter
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func GetDepositGnsAmount -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 100000000

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func SetDepositGnsAmountByAdmin -args 0 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout OK

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func GetDepositGnsAmount -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 0


## unstaking fee getter & setter
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func GetUnstakingFee -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 100

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func SetUnStakingFeeByAdmin -args 0 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout OK

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func GetUnstakingFee -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 0


## staker pool tier
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func GetPoolTier -args "gno.land/r/gnoswap/v1/test_token/bar:gno.land/r/gnoswap/v1/test_token/baz:3000" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '(0 uint64)'

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func SetPoolTierByAdmin -args "gno.land/r/gnoswap/v1/test_token/bar:gno.land/r/gnoswap/v1/test_token/baz:3000" -args 2 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func GetPoolTier -args "gno.land/r/gnoswap/v1/test_token/bar:gno.land/r/gnoswap/v1/test_token/baz:3000" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '(2 uint64)'

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func ChangePoolTierByAdmin -args "gno.land/r/gnoswap/v1/test_token/bar:gno.land/r/gnoswap/v1/test_token/baz:3000" -args 3 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func GetPoolTier -args "gno.land/r/gnoswap/v1/test_token/bar:gno.land/r/gnoswap/v1/test_token/baz:3000" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '(3 uint64)'

gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func RemovePoolTierByAdmin -args "gno.land/r/gnoswap/v1/test_token/bar:gno.land/r/gnoswap/v1/test_token/baz:3000" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/staker -func GetPoolTier -args "gno.land/r/gnoswap/v1/test_token/bar:gno.land/r/gnoswap/v1/test_token/baz:3000" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '(0 uint64)'


# avg blocktime getter & setter
gnokey maketx call -pkgpath gno.land/r/gnoswap/gns -func GetAvgBlockTimeInMs -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 2000

gnokey maketx call -pkgpath gno.land/r/gnoswap/gns -func GetAvgBlockTimeInMs -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 4000


## change emission reward distribution pct
gnokey maketx call -pkgpath gno.land/r/gnoswap/emission -func GetDistributionBpsPct -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '(7500 uint64)'

gnokey maketx call -pkgpath gno.land/r/gnoswap/emission -func ChangeDistributionPctByAdmin -args 1 -args 10000 -args 2 -args 0 -args 3 -args 0 -args 4 -args 0 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/emission -func GetDistributionBpsPct -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '(10000 uint64)'


## delegate to user2
gnokey maketx call -pkgpath gno.land/r/gnoswap/gns -func Approve -args g17e3ykyqk9jmqe2y9wxe9zhep3p7cw56davjqwa -args 18446744073709551615 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/gov/staker -func Delegate -args ${user2_user_addr} -args 5000000000 -args "" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/gov/staker -func GetDelegationAmountFromTo -args ${test1_user_addr} -args ${user2_user_addr} -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '(5000000000 uint64)'


## redelegate partial from user2 to user3
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/gov/staker -func Redelegate -args ${user2_user_addr} -args ${user3_user_addr} -args 200000000 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/gov/staker -func GetDelegationAmountFromTo -args ${test1_user_addr} -args ${user3_user_addr} -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout '(200000000 uint64)'


# propose proposal
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/gov/governance -func ProposeText -args "title01" -args "description01" -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/gov/governance -func GetProposalById -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout 'title01'

# cancel proposal
gnokey maketx call -pkgpath gno.land/r/gnoswap/v1/gov/governance -func Cancel -args 1 -gas-fee 1ugnot -gas-wanted 3000000000 -broadcast -chainid=tendermint_test test1
stdout OK